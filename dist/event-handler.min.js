/* event-handler 2014-08-14 */
!function(a){var b=function(a,b){if(this.entity=a,this.events={all:[]},b)for(var c=0,d=b.length;d>c;c++)this.events[b[c]]=[];this.alias()};b.prototype.alias=function(){this.entity.on=$.proxy(this.on,this),this.entity.once=$.proxy(this.once,this),this.entity.off=$.proxy(this.off,this),this.entity.trigger=$.proxy(this.trigger,this)},b.prototype.on=function(a,b,c){return a in this.events||(this.events[a]=[]),this.events[a].push({action:b,context:c||this.entity}),this.entity},b.prototype.once=function(a,b,c){var d=this,e=function(){d.off(a,e),b.apply(this,arguments)};return e._action=b,this.on(a,e,c)},b.prototype.off=function(a,b,c){if(!b&&!c)return a?this.events[a]=[]:this.clear(),this.entity;var d,e,f,g=this.events[a],h=[];for(d=0,e=g.length;e>d;d++)f=g[d],(b&&b!==f.action&&b!==f.action._action||c&&c!==f.context)&&h.push(f);return this.events[a]=h,this.entity},b.prototype.trigger=function(a,b){return a in this.events&&this.triggerEvents(this.events[a],b||[]),"all"in this.events&&this.triggerEvents(this.events.all,b||[]),this.entity},b.prototype.triggerEvents=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)c=a[d],c.action.call(c.context);break;case 1:for(;++d<e;)c=a[d],c.action.call(c.context,f);break;case 2:for(;++d<e;)c=a[d],c.action.call(c.context,f,g);break;case 3:for(;++d<e;)c=a[d],c.action.call(c.context,f,g,h);break;default:for(;++d<e;)c=a[d],c.action.apply(c.context,b)}},b.prototype.clear=function(){for(var a in this.events)this.events.hasOwnProperty(a)&&(this.events[a]=[])},a.EventHandler=b}("undefined"!=typeof window?window:this);